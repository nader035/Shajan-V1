<section
  class="max-w-2xl mx-auto p-8 sm:p-12 mt-16 Marsa-glass rounded-[3rem] relative overflow-hidden shadow-2xl transition-all duration-500 animate-fade-in"
>
  <div
    class="absolute -top-32 -left-32 w-80 h-80 bg-Marsa-maroon/10 blur-[120px] rounded-full pointer-events-none opacity-40 transition-opacity duration-700"
  ></div>

  <div class="relative z-10">
    <header class="flex flex-col items-center text-center mb-10">
      <div
        class="p-4 bg-[var(--color-Marsa-border)] border border-Marsa-gold/10 rounded-3xl mb-1 text-Marsa-gold shadow-inner transition-colors duration-500"
      >
        <lucide-icon [name]="sparklesIcon" [size]="32" [strokeWidth]="1.2"></lucide-icon>
      </div>

      <h2
        class="text-5xl font-sans font-bold tracking-tight text-[var(--color-foreground)] transition-colors duration-500"
      >
        @if (lang() === 'ar') {
          صدى <span class="text-Marsa-gold">روحك</span>
        } @else {
          Echo <span class="text-Marsa-gold">Your Soul</span>
        }
      </h2>

      <p
        class="opacity-40 text-[16px] font-sans mt-1 tracking-[0.5em] uppercase text-[var(--color-foreground)]"
      >
        {{ lang() === 'ar' ? 'ردد صدى مشاعرك' : 'Reflect your inner Marsa' }}
      </p>
    </header>

    <div class="relative group">
      <textarea
        [ngModel]="store.userInput()"
        (ngModelChange)="store.updateInput($event)"
        [placeholder]="
          lang() === 'ar'
            ? 'بماذا تشعر اليوم؟ شاركنا أفكارك...'
            : 'How are you feeling today? Share your thoughts...'
        "
        class="w-full bg-[var(--color-background)] border border-[var(--color-Marsa-border)] rounded-[2.5rem] p-8 text-xl font-sans placeholder-Marsa-gold/30 focus:outline-none focus:border-Marsa-gold/40 transition-all duration-700 min-h-[220px] leading-relaxed shadow-inner resize-none text-[var(--color-foreground)]"
        style="unicode-bidi: plaintext"
      ></textarea>

      <div
        class="absolute bottom-4 right-8 opacity-0 group-focus-within:opacity-100 transition-opacity duration-700"
      >
        <span class="text-[10px] text-Marsa-gold/40 font-sans tracking-widest uppercase">
          {{ lang() === 'ar' ? 'نمط الكتابة الذكي' : 'Marsa AI Typing Mode' }}
        </span>
      </div>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-10">
      <button
        (click)="generate('quran')"
        [disabled]="store.isLoading() || !store.userInput()"
        class="bg-[var(--color-Marsa-border)] hover:bg-emerald-900/40 hover:text-emerald-200 text-[var(--color-foreground)] py-5 rounded-full flex items-center justify-center gap-3 transition-all active:scale-95 disabled:opacity-20 cursor-pointer border border-transparent hover:border-emerald-500/20 group"
      >
        <lucide-icon
          [name]="bookIcon"
          [size]="18"
          class="text-emerald-500 group-hover:scale-110 transition-transform"
        ></lucide-icon>

      </button>

      <button
        (click)="generate('lyric')"
        [disabled]="store.isLoading() || !store.userInput()"
        class="bg-[var(--color-Marsa-border)] hover:bg-Marsa-maroon hover:text-white text-[var(--color-foreground)] py-5 rounded-full flex items-center justify-center gap-3 transition-all active:scale-95 disabled:opacity-20 cursor-pointer border border-transparent hover:border-Marsa-gold/20"
      >
        <lucide-icon [name]="musicIcon" [size]="18"></lucide-icon>

      </button>

      <button
        (click)="generate('quote')"
        [disabled]="store.isLoading() || !store.userInput()"
        class="bg-[var(--color-Marsa-border)] hover:bg-Marsa-gold hover:text-Marsa-maroon text-[var(--color-foreground)] py-5 rounded-full flex items-center justify-center gap-3 transition-all active:scale-95 disabled:opacity-20 cursor-pointer border border-transparent hover:border-Marsa-maroon/20"
      >
        <lucide-icon [name]="quoteIcon" [size]="18"></lucide-icon>

      </button>
    </div>

    @if (store.isLoading()) {
      <div class="mt-8 flex flex-col items-center gap-3 animate-fade-in">
        <div class="flex gap-2">
          <div class="w-1.5 h-1.5 bg-Marsa-gold rounded-full animate-bounce"></div>
          <div class="w-1.5 h-1.5 bg-Marsa-gold rounded-full animate-bounce delay-150"></div>
          <div class="w-1.5 h-1.5 bg-Marsa-gold rounded-full animate-bounce delay-300"></div>
        </div>
        <p class="text-[9px] font-sans text-Marsa-gold tracking-[0.6em] uppercase opacity-70">
          {{ lang() === 'ar' ? 'جاري الاستحضار' : 'AI Curating' }}
        </p>
      </div>
    }
  </div>
</section>
